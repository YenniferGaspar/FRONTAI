<div class="gemini-container">
  <!-- Header -->
  <div class="chat-header">
    <div class="header-title">
      <div class="gemini-icon">
        <span class="icon-sparkle">✨</span>
      </div>
      <h2>Gemini</h2>
      <span class="version-badge">Advanced</span>
    </div>
    <div class="header-status">
      <span class="status-indicator online"></span>
      <span class="status-text">Listo para ayudarte</span>
    </div>
  </div>

  <div class="chat-layout">
    <!-- Sidebar con historial de conversaciones -->
    <div class="conversations-sidebar">
      <div class="sidebar-header">
        <h3>Conversaciones</h3>
        <button class="new-chat-btn" (click)="startNewConversation()" title="Nueva conversación">
          <span class="plus-icon">+</span>
        </button>
      </div>
      
      <div class="conversations-list">
        <!-- Lista de conversaciones -->
        <div 
          *ngFor="let conversation of conversations" 
          class="conversation-item"
          [class.selected]="selectedConversationId === conversation.id"
          (click)="selectConversation(conversation)">
          <div class="conversation-preview">
            <div class="message-preview">{{ getMessagePreview(conversation.message) }}</div>
            <div class="conversation-time">{{ formatConversationTime(conversation.createdAt) }}</div>
          </div>
          <div class="conversation-actions">
            <button class="action-btn edit-btn" title="Renombrar">
              <span class="edit-icon">✏️</span>
            </button>
            <button 
              class="action-btn delete-btn" 
              (click)="deleteConversation(conversation.id, $event)"
              title="Eliminar">
              <span class="delete-icon">🗑️</span>
            </button>
          </div>
        </div>

        <!-- Estado vacío -->
        <div class="empty-state" *ngIf="conversations.length === 0">
          <span class="empty-icon">💫</span>
          <p>No hay conversaciones aún</p>
          <small>Comienza una nueva conversación</small>
        </div>
      </div>
    </div>

    <!-- Área principal del chat -->
    <div class="chat-main">
      <!-- Área de mensajes -->
      <div class="messages-container" #messagesContainer>
        <!-- Mensaje de bienvenida -->
        <div class="welcome-message" *ngIf="messages.length === 0">
          <div class="welcome-content">
            <div class="welcome-icon">
              <div class="gemini-logo">
                <span class="sparkle-1">✨</span>
                <span class="sparkle-2">⭐</span>
                <span class="sparkle-3">💫</span>
              </div>
            </div>
            <h3>¡Hola! Soy Gemini</h3>
            <p>Tu asistente de IA avanzado de Google. Estoy aquí para ayudarte con preguntas, tareas creativas, análisis de código y mucho más.</p>
            <div class="welcome-suggestions">
              <button 
                *ngFor="let suggestion of suggestions"
                class="suggestion-btn"
                (click)="useSuggestion(suggestion)">
                <span class="suggestion-icon">{{ suggestion.icon }}</span>
                <span>{{ suggestion.text }}</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Mensajes de la conversación -->
        <div class="message-group" *ngIf="messages.length > 0">
          <div *ngFor="let message of messages" class="message" [class.user-message]="message.isUser" [class.gemini-message]="!message.isUser">
            <!-- Avatar -->
            <div class="message-avatar">
              <span *ngIf="message.isUser" class="avatar-icon user-avatar">👤</span>
              <div *ngIf="!message.isUser" class="gemini-avatar">
                <span class="avatar-sparkle">✨</span>
              </div>
            </div>

            <!-- Contenido del mensaje -->
            <div class="message-content">
              <div class="message-bubble" [class.user-bubble]="message.isUser" [class.gemini-bubble]="!message.isUser">
                <div class="response-text" [innerHTML]="message.content"></div>
              </div>
              
              <!-- Acciones del mensaje (solo para respuestas de Gemini) -->
              <div class="message-actions" *ngIf="!message.isUser">
                <button class="action-btn copy-btn" (click)="copyMessage(message.content)" title="Copiar">📋</button>
                <button class="action-btn like-btn" title="Me gusta">👍</button>
                <button class="action-btn dislike-btn" title="No me gusta">👎</button>
                <button class="action-btn regenerate-btn" (click)="regenerateResponse(message)" title="Regenerar">🔄</button>
              </div>
              
              <div class="message-time">{{ formatTime(message.timestamp) }}</div>
            </div>
          </div>
        </div>

        <!-- Indicador de carga -->
        <div class="message gemini-message" *ngIf="isLoading">
          <div class="message-avatar">
            <div class="gemini-avatar loading">
              <span class="avatar-sparkle">✨</span>
            </div>
          </div>
          <div class="message-content">
            <div class="message-bubble gemini-bubble">
              <div class="typing-indicator">
                <div class="typing-dots">
                  <span></span>
                  <span></span>
                  <span></span>
                </div>
                <span class="typing-text">Gemini está escribiendo...</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Área de entrada de mensaje -->
      <div class="input-area">
        <div class="input-container">
          <div class="input-wrapper">
            <div class="input-actions-left">
              <button class="attachment-btn" title="Adjuntar archivo">
                <span class="attachment-icon">📎</span>
              </button>
              <button class="image-btn" title="Subir imagen">
                <span class="image-icon">🖼️</span>
              </button>
            </div>
            <textarea
              #messageInput
              [(ngModel)]="currentMessage"
              (keydown)="onKeyDown($event)"
              placeholder="Pregunta cualquier cosa a Gemini..."
              class="message-input"
              rows="1"
              [disabled]="isLoading"></textarea>
            <button 
              class="send-button" 
              (click)="sendMessage()"
              [disabled]="!currentMessage.trim() || isLoading"
              title="Enviar mensaje (Ctrl+Enter)">
              <span class="send-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                </svg>
              </span>
            </button>
          </div>
          <div class="input-hint">
            Gemini puede cometer errores. Verifica la información importante.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>